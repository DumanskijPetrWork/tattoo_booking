# Техническое задание

- [Техническое задание](#техническое-задание)
  - [1 Цель проекта](#1-цель-проекта)
  - [2 Описание системы](#2-описание-системы)
    - [2.1 Типы пользователей (роли)](#21-типы-пользователей-роли)
    - [2.2 Регистрация](#22-регистрация)
    - [2.3 Аутентификация](#23-аутентификация)
    - [2.4 Редактирование профиля Партнера](#24-редактирование-профиля-партнера)
    - [2.5 Функционал для Пользователя](#25-функционал-для-пользователя)
    - [2.6 Функционал бронирования и оплаты](#26-функционал-бронирования-и-оплаты)
      - [2.6.1 Модель оплаты](#261-модель-оплаты)
      - [2.6.2 Уведомления о бронировании](#262-уведомления-о-бронировании)
      - [2.6.3 Электронный сертификат](#263-электронный-сертификат)
    - [2.7 Функционал интеграции с Telegram](#27-функционал-интеграции-с-telegram)
    - [2.8 Аналитика](#28-аналитика)
  - [3 Предлагаемый стек технологий](#3-предлагаемый-стек-технологий)
  - [4 Дизайн и верстка](#4-дизайн-и-верстка)
  - [5 Возможности масштабирования](#5-возможности-масштабирования)

## 1 Цель проекта

Цель проекта — разработать систему для продажи татуировок по модели букинг-сервиса (далее Система).

Система ориентирована на покупателей (далее Пользователь) и исполнителей (частные мастера и студии) (далее Партнер).

Партнер сможет создать в Системе свой профиль, размещать соответствующие товары и/или услуги, управлять их стоимостью, размещать и принимать бронирование на услуги от Пользователей.

Пользователь сможет получать актуальную ленту предложений по запросу товара и/или услуги, соответствующую выбранному местоположению, бронировать и оплачивать товар и/или услугу.
После оплаты пользователь получает электронный сертификат, подтверждающий бронирование.

Помимо этого в Системе должно быть предусмотрено администрирование,
добавляются роли Менеджера и Администратора и панель управления для них.

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

## 2 Описание системы

Система состоит из следующих основных функциональных блоков:

1. Главная страница
   - Лента
   - Поиск
   - Фильтрация
   - Текущие бонусы/скидки/предложения
   - Меню навигации

2. Регистрация, аутентификация и авторизация Пользователя

3. Регистрация, аутентификация и авторизация Партнера

4. Функционал бронирования и оплаты для Пользователя
   - Календарь свободных дат и времени
   - Выбор вариантов оплаты

5. Личный кабинет Пользователя
   - Список желаний (понравившиеся товары)
   - Текущие записи на сеансы
   - Связь с мастером или поддержкой (первая рабочая версии Системы не включает онлайн-чат для связи. Отображается список контактов мастера и поддержки)

6. Личный кабинет Партнера
   - Панель редактирования данных профиля
   - Календарь с текущими записями + назначение свободных дат
   - Добавление и изменение товаров

7. Страница Партнера
   - Профиль с описанием и подробной информацией
   - Календарь доступных для брони дат и времени
   - Карточки товаров
   - Фотогалерея работ
   - Теги (например стили, в которых работает мастер)
   - Рейтинг
   - Отзывы (не включены в первую рабочую версию Системы)

8. Карточка товара и/или услуги
   - Фотогалерея товара
   - Теги
   - Ценовой диапазон + вариации (доступные размеры, цвета и тд.)
   - Кнопка заказа (выбрать дату и положить в корзину для оплаты) или мгновенный переход к оплате и бронированию

9. Панель администрирования
   - Аналитика (не включена в первую рабочую версию Системы)
   - Управление (добавление и редактирование ролей, блокировка профилей)

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

### 2.1 Типы пользователей (роли)

1. Пользователь (поиск, регистрация, оплата, личный кабинет пользователя)
2. Партнер (доступ: Пользователь + управление личным кабинетом партнера, прием платежей)
3. Менеджер (доступ: Пользователь + панель управления, блокировка пользователей)
4. Администратор (доступ: Менеджер + раздача ролей)

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

### 2.2 Регистрация

Регистрация Пользователя требует на вход следующие данные:

- Телефон — <u>обязательное поле</u>
- Имя и фамилия — *опциональное поле*
- Email — *опциональное поле* // TODO

Регистрация Партнера требует на вход следующие данные:

- Телефон — <u>обязательное поле</u>
- Email — <u>обязательное поле</u>
- Имя и фамилия — <u>обязательное поле</u>
- Пароль? — <u>обязательное поле</u> (нужен ли?) // TODO

После отправки формы регистрации Пользователя ему на на номер телефона приходит одноразовый код для подтверждения аккаунта.

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

### 2.3 Аутентификация

Аутентификация Пользователя осуществляется по номеру телефона и одноразовому коду, который приходит на этот номер.

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

### 2.4 Редактирование профиля Партнера

В этом разделе у Партнера есть возможность изменения следующих данных своего профиля:

- Контактные данные
- Геолокация
- Описание
- Ссылки на соц. сети
- Фотогалерея
- Фотография профиля

Должна быть возможность сменить пароль. // TODO

Кроме того, Партнер добавляет карточки товаров, добавляет вариации, назначает и меняет стоимость, добавляет фотографии для карточек.
Размер и разрешение загружаемых фотографий должны быть ограничены.

Партнер назначает свободные даты и время сеансов в календаре на своей странице.

Партнер получает уведомления о записях на сеансы в своем личном кабинете.

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

### 2.5 Функционал для Пользователя

Пользователь может просматривать ленту предложений по выбранной геолокации, осуществлять поиск с фильтрами по товарам или исполнителям услуг.

Пользователь может бронировать и оплачивать товар/услугу, сохранять и удалять из базы данных свою платежную информацию.

Пользователь может просматривать оплаченные заказы в личном кабинете.
Необходимо реализовать возможность предварительной отмены заказа (за определенное время до сеанса) с возвратом средств.

Пользователь может оценивать услугу после ее оказания на странице Партнера. В первой рабочей версии системы Комментарии не предусмотрены.

Каждый товар или страницу Партнера можно добавить в избранное, которые будут отображаться в личном кабинете в соответствующем разделе.

Каждый товар и страница содержит свою постоянную ссылку, которой может поделиться Пользователь.

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

### 2.6 Функционал бронирования и оплаты

Пользователь на странице Партнера выбирает необходимую карточку товара/услуги и вариацию, нажимает кнопку бронирования. Далее выбирает в календаре свободную дату и время из доступных, после чего переходит к оплате. Оплаченный заказ добавляется в личные кабинеты Пользователя и Партнера. Пользователь получает электронный сертификат, подтверждающий запись и оплату.

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

#### 2.6.1 Модель оплаты

- провайдер сервиса интернет-эквайринга? (выбрать) // TODO
- рекуррентные платежи? // TODO

Система в своей первой рабочей версии не включает возможность оплаты за пределами РФ.

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

#### 2.6.2 Уведомления о бронировании

Автоматически Пользователям должны приходить SMS-уведомления на номер телефона о статусе бронирования и оплаты.

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

#### 2.6.3 Электронный сертификат

// TODO

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

### 2.7 Функционал интеграции с Telegram

Система в своей первой рабочей версии не включает интеграцию с Telegram.

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

### 2.8 Аналитика

Система в своей первой рабочей версии не включает аналитику.

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

## 3 Предлагаемый стек технологий

Для реализации Системы предлагается следующий стек технологий:

- Backend:
  - Язык JavaScript на платформе Node.js + TypeScript
  - Фреймворк Nest.js
  - БД PostgreSQL
  - Prisma (либо Sequelize) ORM
- Frontend:
  - Next.js
  - TypeScript

Хранение файлов и изображений должно осуществляться в S3-совместимом хранилище.

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

## 4 Дизайн и верстка

- Mobile-first подход к верстке (ориентированность на мобильную версию сайта)
- Адаптивная верстка

<div align="right"><b><a href="#">Наверх ↥</a></b></div>

## 5 Возможности масштабирования

Возможности масштабирования не включены в первую рабочую версию Системы, но подразумевается построение такой архитектуры кода, которая позволит легко и быстро внедрять новый функционал.

- Кеширование redis (в разы ускоряет взаимодействие пользователя с сервером)
- Разбиение на микросервисную архитектуру (каждая часть приложения обособлена и может располагаться на отдельном сервере, что повысит надежность системы. При обновлении конкретного модуля или при проблемах со стороны сервера остальное приложение будет продолжать работать без остановок. Также упростится добавление нового функционала)
- Распределение пиковых нагрузок на несколько серверов (nginx + docker, kubernetes)
- Уведомления клиента через почтовую или sms рассылку / телеграм бота
- Мобильное web-приложение для телефонов на react native (позволяет удобно взаимодействовать с сайтом как с приложением на телефоне)
- Аналитика действий клиентов
- Подключение рассрочки для клиентов
- SEO-оптимизация для высоких позиций в поисковой выдаче

<div align="right"><b><a href="#">Наверх ↥</a></b></div>
